<!DOCTYPE html>

<html lang="ru">

<head>

	<meta charset="UTF-8">
	<meta name="yandex-verification" content="3d1d39fe020777f1" />

	<title>EMDS Animation</title>



	<link rel="stylesheet" href="css/style.css">

</head>



<body data-emds-bg="video/ocean">
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="./scripts/jquery.emds.js"></script>


	<header class="demo-header cf">

		<h1>ЕМДСофт</h1>

		<a id="switch" href="#">Контакты</a>

	</header>



	<div class="container">



		<svg width="160mm" height="160mm" viewBox="0 0 160 160" xmlns="http://www.w3.org/2000/svg" class="emds">


    <defs id="defs01">
        <filter id="cool" x="-.276" width="1.553" y="-.276" height="1.551" color-interpolation-filters="sRGB">
            <feGaussianBlur stdDeviation="1.855"/>
        </filter>
    </defs>
    <g transform="translate(0 -137)">
        <ellipse cx="81.878" cy="177.621" rx="34.843" ry="34.236" fill="#0070ff"/>
        <path d="M42.622 276.33H13.868v-52.682h28.754v6.227l-21.439-.378-1.512 15.38 22.95 1.512v4.148l-22.76 2.08 2.267 18.242 20.494-.756z" paint-order="stroke fill markers" aria-label="E" font-weight="400" font-size="65.952" font-family="sans-serif" letter-spacing="0" word-spacing="0" fill="red" stroke-width="1.649"/>
        <path d="M76.837 261.863l-7.834-.19 2.835-32.694-10.451 22.375h-2.98L48.033 228.98l3.213 32.884h-7.883V223.7h6.816l9.833 15.955 9.883-15.955h6.943z" fill="red" aria-label="M" font-weight="400" font-size="52.094" font-family="sans-serif" letter-spacing="0" word-spacing="0" stroke-width="1.302"/>
        <path d="M104.83 241.032c0 3.154-.641 6.013-1.925 8.576-1.269 2.564-2.963 4.552-5.083 5.966-1.471.98-3.115 1.686-4.932 2.121-1.803.435-4.183.653-7.139.653h-8.134v-34.701h8.047c3.144 0 5.64.248 7.485.745 1.86.482 3.432 1.15 4.716 2.005 2.192 1.476 3.9 3.441 5.127 5.896 1.226 2.454 1.838 5.368 1.838 8.739zm-10.336-.448c0-2.719 5.419-4.632 4.539-6.497a10.136 10.136 0 0 0-3.937-4.404 12.574 12.574 0 0 0-4.045-1.608c-1.428-.311-3.137-.467-5.127-.467H81.9l4.024 26.778s3.858-.163 5.386-.49a11.625 11.625 0 0 0 4.24-1.818 10.154 10.154 0 0 0 3.591-4.358c.808-1.802-4.647-4.433-4.647-7.136z" fill="red" aria-label="D" font-weight="400" font-size="45.983" font-family="sans-serif" letter-spacing="0" word-spacing="0" stroke-width="1.15"/>
        <g aria-label="Soft" style="line-height:1.25" font-weight="400" font-size="40.293" font-family="sans-serif" letter-spacing="0" word-spacing="0" fill="#0070ff" stroke-width="1.007">
            <path d="M79.125 272.374c0 1.103-.278 2.193-.835 3.27a7.786 7.786 0 0 1-2.3 2.739c-1.085.811-2.354 1.445-3.806 1.902-1.438.456-3.175.684-5.21.684-2.186 0-4.153-.19-5.904-.57a31.473 31.473 0 0 1-5.312-1.693v-4.716h.285c1.533 1.192 3.304 2.11 5.312 2.757 2.009.647 3.895.97 5.659.97 2.497 0 4.437-.437 5.821-1.312 1.398-.875-2.817-1.474-2.817-2.932 0-1.255 4.581-2.748 3.916-3.343-.651-.596-1.648-1.059-2.992-1.389a31.657 31.657 0 0 0-3.318-.627 77.045 77.045 0 0 1-3.765-.628c-2.687-.532-4.682-1.439-5.984-2.72-1.29-1.292-1.934-2.972-1.934-5.039 0-2.37 1.072-4.31 3.216-5.819 2.144-1.521 4.865-2.282 8.162-2.282 2.13 0 4.085.19 5.862.57 1.778.381 3.352.85 4.722 1.408v4.45h-.284c-1.154-.913-2.674-1.667-4.56-2.263a18.524 18.524 0 0 0-5.76-.913c-2.158 0-3.895.418-5.21 1.255-1.304.837 2.58 2.482 2.58 3.8 0 1.18-4.21 1.538-3.558 2.21.651.671 1.798 1.185 3.44 1.54a90.36 90.36 0 0 0 3.704.646c1.602.254 2.959.514 4.071.78 2.253.558 3.95 1.401 5.089 2.53 1.14 1.128 1.71 2.706 1.71 4.735zM104.67 269.844c0 3.461-.95 6.193-2.85 8.197-1.9 2.003-4.444 3.004-7.633 3.004-3.216 0-5.774-1.001-7.674-3.004-1.886-2.004-2.829-4.736-2.829-8.197 0-3.46.943-6.193 2.83-8.196 1.9-2.016 4.457-3.024 7.673-3.024 3.189 0 5.733 1.008 7.633 3.024 1.9 2.003 2.85 4.735 2.85 8.196zm-9.808.378c0-2.75 5.282-5.17 4.129-6.501-1.154-1.344-2.755-2.205-4.804-2.205-2.076 0-3.69.861-4.844 2.205-1.14 1.331 4.149 3.75 4.149 6.501 0 2.663-5.282 4.307-4.129 5.689 1.153 1.369 2.761 2.053 4.824 2.053 2.035 0 3.63-.678 4.783-2.034 1.167-1.37-4.108-3.02-4.108-5.708zM122.846 254.327h-.204c-.42-.114-.97-.229-1.648-.343a9.9 9.9 0 0 0-1.791-.19c-1.642 0-2.836.342-3.583 1.027-.733.672-1.099 1.895-1.099 3.67v.723h6.9v3.005h-6.778l5.292 18.237h-9.118v-18.237h-2.585v-3.005h2.585v-.704c0-2.523.671-4.456 2.015-5.8 1.343-1.356 3.283-2.035 5.821-2.035.855 0 1.622.038 2.3.114a28.87 28.87 0 0 1 1.893.267zM137.074 280.265c-.72.178-1.506.324-2.361.438-.842.114-1.595.171-2.26.171-2.32 0-4.084-.583-5.292-1.75-1.208-1.166-1.811-3.036-1.811-5.61V262.22h-2.585v-3.005h2.585v-6.104l5.15-.19-1.324 6.294h7.898v3.005h-7.898v9.68c0 1.115.027 1.99.082 2.623a4.06 4.06 0 0 0 .57 1.75c.298.507.705.881 1.22 1.122.53.228 1.33.342 2.403.342.624 0 1.275-.082 1.954-.247.678-.177 1.167-.323 1.465-.437h.204z"/>
        </g>
        <path d="M-53.15 67.14c.604.137.113.882-.228 1.004-.925.331-1.71-.626-1.781-1.46-.127-1.494 1.302-2.578 2.694-2.558 2.042.03 3.46 1.984 3.333 3.927-.17 2.59-2.668 4.352-5.16 4.11-3.135-.305-5.245-3.353-4.885-6.393.435-3.682 4.037-6.141 7.625-5.662 4.23.565 7.038 4.722 6.438 8.858-.692 4.776-5.407 7.936-10.09 7.215-5.323-.82-8.835-6.092-7.992-11.324.947-5.87 6.747-9.408 12.564-8.7 7.112.864 12.034 12.995 5.505 17.702" transform="matrix(2.77176 1.64675 -1.64373 2.77684 336.996 80.702)" fill="none" stroke="#000" stroke-width="1.165"/>
        <path d="M15.379 176.775c71.286 79.912 129.562-.443 133.308 1.049M15.379 180.581c71.286-79.912 129.562.443 133.308-1.049" fill="none" stroke="#000" stroke-width="4.977"/>
        <ellipse cx="80.444" cy="177.4" rx="8.056" ry="8.071" transform="matrix(1.47282 0 0 1.28463 -37.47 -50.494)" fill="red" filter="url(#cool)"/>
    </g>
		   

		</svg>

	</div>




 <script type="text/javascript">
/*var filters = document.querySelector(".emds"),
    defs = filters.querySelector("#defs01"),
*/
var    blur = document.querySelector("#cool"),
    start = null,
    animationActive = false,
    animDuration = null,
    blurFilter = blur.firstElementChild;

    function setBlur(fill) {
	blur.setAttribute("x", fill.x);
	blur.setAttribute("y", fill.y);
	blur.setAttribute("width", fill.w);
	blur.setAttribute("height", fill.h);

    	blurFilter.setAttribute("stdDeviation", fill.dev);
    }

    function microtime(get_as_float) {
     var now = new Date().getTime() / 1000;
     var s = parseInt(now, 10);
     return (get_as_float) ? now : (Math.round((now - s) * 1000) / 1000) + ' ' + s;
    }

    function stepMotionBlur(duration) {
    	if (!animDuration)
      	animDuration = duration;
      if (!start)
      	start = microtime(true);
      var nowTime = microtime(true);
      var progress = nowTime - start;
      var percProgress = progress * 100 / animDuration * 10;

      if (percProgress > .8) {
      	setBlur({x:"-.008", w:"1.017",y:"-.008", h:"1.017", dev:"0.057"});
    var blur = document.querySelector("#cool");
    console.log("update 1");

    console.log(blur.getAttribute("x"));
    console.log(blur.getAttribute("y"));
    console.log(blur.getAttribute("width"));
    console.log(blur.getAttribute("height"));
    blurFilter = blur.firstElementChild;
    console.log(blurFilter.getAttribute("stdDeviation"));

      } else {
     	setBlur({x:"-.008", w:"1.017",y:"-.008", h:"1.017", dev:"0.057"});
    var blur = document.querySelector("#cool");
    console.log("update 2");

    console.log(blur.getAttribute("x"));
    console.log(blur.getAttribute("y"));
    console.log(blur.getAttribute("width"));
    console.log(blur.getAttribute("height"));
    blurFilter = blur.firstElementChild;
    console.log(blurFilter.getAttribute("stdDeviation"));

      }
      if (percProgress >= 1) {
      	setBlur({x:"-.276", w:"1.553",y:"-.276", h:"1.551", dev:"1.855"});
        start = null;
        animationActive = false;
        return;
      }
      requestAnimationFrame(stepMotionBlur);
   }

window.onload = function () {

    var blur = document.querySelector("#cool");

    console.log(blur.getAttribute("x"));
    console.log(blur.getAttribute("y"));
    console.log(blur.getAttribute("width"));
    console.log(blur.getAttribute("height"));
    blurFilter = blur.firstElementChild;
    console.log(blurFilter.getAttribute("stdDeviation"));

    //получаем идентификатор элемента
    var a = document.getElementById('switch');
    
    //вешаем на него событие
    a.onclick = function() {
        //производим какие-то действия
        if (this.innerHTML=='On'){
      	setBlur({x:"-.276", w:"1.553",y:"-.276", h:"1.551", dev:"1.855"});

 this.innerHTML = 'Off';
}
        else {
     	setBlur({x:"-.008", w:"1.017",y:"-.008", h:"1.017", dev:"0.057"});

this.innerHTML = 'On';   }
  	if (!animationActive) {
    		animationActive = true;
//    	  $(this).next().toggleClass('animate');
    var blur = document.querySelector("#cool");

    console.log(blur.getAttribute("x"));
    console.log(blur.getAttribute("y"));
    console.log(blur.getAttribute("width"));
    console.log(blur.getAttribute("height"));
    blurFilter = blur.firstElementChild;
    console.log(blurFilter.getAttribute("stdDeviation"));

     //	 stepMotionBlur(300);
    	}
    var blur = document.querySelector("#cool");

    console.log(blur.getAttribute("x"));
    console.log(blur.getAttribute("y"));
    console.log(blur.getAttribute("width"));
    console.log(blur.getAttribute("height"));
    blurFilter = blur.firstElementChild;
    console.log(blurFilter.getAttribute("stdDeviation"));

        //предотвращаем переход по ссылке href
        return false;
    }
}
</script>



</body>

</html>